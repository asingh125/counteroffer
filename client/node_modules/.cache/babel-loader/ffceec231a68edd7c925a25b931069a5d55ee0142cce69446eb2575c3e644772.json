{"ast":null,"code":"/* eslint-disable no-console */\n'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar EventEmitter = require('events').EventEmitter;\nvar VALID_GROUPS = ['signaling', 'room', 'media', 'quality', 'video-processor', 'preflight'];\nvar VALID_LEVELS = ['debug', 'error', 'info', 'warning'];\n/**\n * EventObserver listens to SDK events and re-emits them on the\n * @link EventListener} with some additional information.\n * @extends EventEmitter\n * @emits EventObserver#event\n */\nvar EventObserver = /** @class */function (_super) {\n  __extends(EventObserver, _super);\n  /**\n   * Constructor.\n   * @param {InsightsPublisher} publisher\n   * @param {number} connectTimestamp\n   * @param {Log} log\n   * @param {EventListener} [eventListener]\n   */\n  function EventObserver(publisher, connectTimestamp, log, eventListener) {\n    if (eventListener === void 0) {\n      eventListener = null;\n    }\n    var _this = _super.call(this) || this;\n    _this.on('event', function (_a) {\n      var name = _a.name,\n        group = _a.group,\n        level = _a.level,\n        payload = _a.payload;\n      if (typeof name !== 'string') {\n        log.error('Unexpected name: ', name);\n        throw new Error('Unexpected name: ', name);\n      }\n      if (!VALID_GROUPS.includes(group)) {\n        log.error('Unexpected group: ', group);\n        throw new Error('Unexpected group: ', group);\n      }\n      if (!VALID_LEVELS.includes(level)) {\n        log.error('Unexpected level: ', level);\n        throw new Error('Unexpected level: ', level);\n      }\n      var timestamp = Date.now();\n      var elapsedTime = timestamp - connectTimestamp;\n      var publisherPayload = Object.assign({\n        elapsedTime: elapsedTime,\n        level: level\n      }, payload ? payload : {});\n      publisher.publish(group, name, publisherPayload);\n      var event = Object.assign({\n        elapsedTime: elapsedTime,\n        group: group,\n        level: level,\n        name: name,\n        timestamp: timestamp\n      }, payload ? {\n        payload: payload\n      } : {});\n      var logLevel = {\n        debug: 'debug',\n        error: 'error',\n        info: 'info',\n        warning: 'warn'\n      }[level];\n      log[logLevel]('event', event);\n      if (eventListener && group === 'signaling') {\n        eventListener.emit('event', event);\n      }\n    });\n    return _this;\n  }\n  return EventObserver;\n}(EventEmitter);\n/**\n * An SDK event.\n * @event EventObserver#event\n * @param {{name: string, payload: *}} event\n */\nmodule.exports = EventObserver;","map":{"version":3,"mappings":"AAAA;AACA,YAAY;;;;;;;;;;;;;;;;;;;;;;AAEJ,gBAAY,GAAKA,OAAO,CAAC,QAAQ,CAAC,aAAtB;AAEpB,IAAMC,YAAY,GAAG,CACnB,WAAW,EACX,MAAM,EACN,OAAO,EACP,SAAS,EACT,iBAAiB,EACjB,WAAW,CACZ;AAED,IAAMC,YAAY,GAAG,CACnB,OAAO,EACP,OAAO,EACP,MAAM,EACN,SAAS,CACV;AAED;;;;;;AAMA;EAA4BC;EAC1B;;;;;;;EAOA,uBAAYC,SAAS,EAAEC,gBAAgB,EAAEC,GAAG,EAAEC,aAAoB;IAApB;MAAAA,oBAAoB;IAAA;IAAlE,YACEC,iBAAO;IACPC,KAAI,CAACC,EAAE,CAAC,OAAO,EAAE,UAACC,EAA+B;UAA7BC,IAAI;QAAEC,KAAK;QAAEC,KAAK;QAAEC,OAAO;MAC7C,IAAI,OAAOH,IAAI,KAAK,QAAQ,EAAE;QAC5BN,GAAG,CAACU,KAAK,CAAC,mBAAmB,EAAEJ,IAAI,CAAC;QACpC,MAAM,IAAIK,KAAK,CAAC,mBAAmB,EAAEL,IAAI,CAAC;;MAG5C,IAAI,CAACX,YAAY,CAACiB,QAAQ,CAACL,KAAK,CAAC,EAAE;QACjCP,GAAG,CAACU,KAAK,CAAC,oBAAoB,EAAEH,KAAK,CAAC;QACtC,MAAM,IAAII,KAAK,CAAC,oBAAoB,EAAEJ,KAAK,CAAC;;MAG9C,IAAI,CAACX,YAAY,CAACgB,QAAQ,CAACJ,KAAK,CAAC,EAAE;QACjCR,GAAG,CAACU,KAAK,CAAC,oBAAoB,EAAEF,KAAK,CAAC;QACtC,MAAM,IAAIG,KAAK,CAAC,oBAAoB,EAAEH,KAAK,CAAC;;MAG9C,IAAMK,SAAS,GAAGC,IAAI,CAACC,GAAG,EAAE;MAC5B,IAAMC,WAAW,GAAGH,SAAS,GAAGd,gBAAgB;MAEhD,IAAMkB,gBAAgB,GAAGC,MAAM,CAACC,MAAM,CAAC;QAAEH,WAAW;QAAER,KAAK;MAAA,CAAE,EAAEC,OAAO,GAAGA,OAAO,GAAG,EAAE,CAAC;MACtFX,SAAS,CAACsB,OAAO,CAACb,KAAK,EAAED,IAAI,EAAEW,gBAAgB,CAAC;MAEhD,IAAMI,KAAK,GAAGH,MAAM,CAACC,MAAM,CAAC;QAC1BH,WAAW;QACXT,KAAK;QACLC,KAAK;QACLF,IAAI;QACJO,SAAS;OACV,EAAEJ,OAAO,GAAG;QAAEA,OAAO;MAAA,CAAE,GAAG,EAAE,CAAC;MAE9B,IAAMa,QAAQ,GAAG;QACfC,KAAK,EAAE,OAAO;QACdb,KAAK,EAAE,OAAO;QACdc,IAAI,EAAE,MAAM;QACZC,OAAO,EAAE;OACV,CAACjB,KAAK,CAAC;MACRR,GAAG,CAACsB,QAAQ,CAAC,CAAC,OAAO,EAAED,KAAK,CAAC;MAE7B,IAAIpB,aAAa,IAAIM,KAAK,KAAK,WAAW,EAAE;QAC1CN,aAAa,CAACyB,IAAI,CAAC,OAAO,EAAEL,KAAK,CAAC;;IAEtC,CAAC,CAAC;;EACJ;EACF,oBAAC;AAAD,CAAC,CArD2BM,YAAY;AAuDxC;;;;;AAMAC,MAAM,CAACC,OAAO,GAAGC,aAAa","names":["require","VALID_GROUPS","VALID_LEVELS","__extends","publisher","connectTimestamp","log","eventListener","_super","_this","on","_a","name","group","level","payload","error","Error","includes","timestamp","Date","now","elapsedTime","publisherPayload","Object","assign","publish","event","logLevel","debug","info","warning","emit","EventEmitter","module","exports","EventObserver"],"sources":["/Users/aarushisingh/Projects/counteroffer/client/node_modules/twilio-video/lib/util/eventobserver.js"],"sourcesContent":["/* eslint-disable no-console */\n'use strict';\n\nconst { EventEmitter } = require('events');\n\nconst VALID_GROUPS = [\n  'signaling',\n  'room',\n  'media',\n  'quality',\n  'video-processor',\n  'preflight'\n];\n\nconst VALID_LEVELS = [\n  'debug',\n  'error',\n  'info',\n  'warning'\n];\n\n/**\n * EventObserver listens to SDK events and re-emits them on the\n * @link EventListener} with some additional information.\n * @extends EventEmitter\n * @emits EventObserver#event\n */\nclass EventObserver extends EventEmitter {\n  /**\n   * Constructor.\n   * @param {InsightsPublisher} publisher\n   * @param {number} connectTimestamp\n   * @param {Log} log\n   * @param {EventListener} [eventListener]\n   */\n  constructor(publisher, connectTimestamp, log, eventListener = null) {\n    super();\n    this.on('event', ({ name, group, level, payload }) => {\n      if (typeof name !== 'string') {\n        log.error('Unexpected name: ', name);\n        throw new Error('Unexpected name: ', name);\n      }\n\n      if (!VALID_GROUPS.includes(group)) {\n        log.error('Unexpected group: ', group);\n        throw new Error('Unexpected group: ', group);\n      }\n\n      if (!VALID_LEVELS.includes(level)) {\n        log.error('Unexpected level: ', level);\n        throw new Error('Unexpected level: ', level);\n      }\n\n      const timestamp = Date.now();\n      const elapsedTime = timestamp - connectTimestamp;\n\n      const publisherPayload = Object.assign({ elapsedTime, level }, payload ? payload : {});\n      publisher.publish(group, name, publisherPayload);\n\n      const event = Object.assign({\n        elapsedTime,\n        group,\n        level,\n        name,\n        timestamp\n      }, payload ? { payload } : {});\n\n      const logLevel = {\n        debug: 'debug',\n        error: 'error',\n        info: 'info',\n        warning: 'warn',\n      }[level];\n      log[logLevel]('event', event);\n\n      if (eventListener && group === 'signaling') {\n        eventListener.emit('event', event);\n      }\n    });\n  }\n}\n\n/**\n * An SDK event.\n * @event EventObserver#event\n * @param {{name: string, payload: *}} event\n */\n\nmodule.exports = EventObserver;\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}